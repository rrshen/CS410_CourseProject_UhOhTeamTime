# Text-Based Game Enhanced By AI

Originally, my proposal was as described in ProjectProposal.md; I wanted to create a software application that will use sentiment analysis and pattern matching to rank the appropriateness of follow-up reactions to question-answer pairs. However, I spoke with the professor during Office Hours, and he inquired as to my motivation for this project. I explained that I had been inspired while playing text-based games, and Professor Zhai suggested that I use existing language models such as GPT-3 to improve text-based games rather than attempting to basically reproduce a functionality that existing advanced chatbots have already tried to implement. So instead of following through with my original plan, I have pivoted to enhancing a text-based game using AI. 

## Team Members

**Captain** Rachel Shen (rrshen2)

## Topic

My free topic is using a deep learning language model to increase the level of personalization involved in text-based games. This is interesting and innovative, because one limitation that most games with dialogue have always had is the inherent inability of a computer program to adapt to the player's choices. All of the possible options must be addressed during production; a writer cannot just add new lines to a game as the player plays, so if a character asks "How are you?", most games will give the player options with similar meanings to give the illusion of choice when there aren't that many available. For example, here are some dialogue options from modern games:

![image](https://user-images.githubusercontent.com/42553808/205719491-2471f506-00cf-4395-980d-45d9b9df8562.png)

![image](https://user-images.githubusercontent.com/42553808/205719722-19dc3218-ff36-4ba0-98fc-03c41fe2c6a3.png)

It can be very frustrating as a player to feel as if your choices do not matter. However, it is also not very fun to play a game where you must read through large blocks of text without being able to interact with it. An AI such as the GPT-3 Davinci model addresses these frustrations by allowing more free exchanges, because the AI can adjust its response depending on the player's choices.

![image](https://user-images.githubusercontent.com/42553808/205720622-eb28c421-e2b2-4cc7-ba69-e0cc4da4be60.png)

![image](https://user-images.githubusercontent.com/42553808/205720957-c642a185-4972-4916-b095-7273de6e2ccf.png)

The green text is generated by OpenAI API's GPT-3 Davinci model, which I chose for my project because it was the most robust model that I could find online. As you can see, it is able to produce a pretty human-like, appropriate response to a variety of prompts.

After running into problems integrating OpenAI with Ren'Py, a popular visual novel engine, I decided to use Google Colaboratory to run my text-based game. I expect to be able to play all the way through a short text-based game with reactive casual conversation as well as open-ended player input that directly impacts the gameplay. I will evaluate my work by playing through different endings.

## Programming Language

Python

## How to Use

1. Make a copy of the CS410FinalProject.ipynb Colab notebook
2. Open the table of contents on the left side and skip to the section titled 'Play the Game'
![image](https://user-images.githubusercontent.com/42553808/206591884-6af5d78f-b8fc-4f91-933a-0507523be7b7.png)
2. Click on the section of code that begins with "def game_loop():". Then, click Runtime -> Run before on the toolbar.
![image](https://user-images.githubusercontent.com/42553808/206592034-b7e17100-e48c-4554-88cc-a9d87e9de9f5.png)
3. Click the play button on the left of the code block you're in. Then, enter text when prompted.
![image](https://user-images.githubusercontent.com/42553808/206592160-9431a342-f1ca-4671-8e41-3e625593a5a9.png)

Use commands such as "go [exit name]" or "take [item name]" to play. Other potential actions you can take will be printed with an indent.

For example, if the text reads:

![image](https://user-images.githubusercontent.com/42553808/206592662-2fc80e13-3e3f-456c-b58f-7f24c79a3a05.png)
  
You could type "go to your room" to go to your room or "talk to her" to talk to your girlfriend. Some actions, such as proposing with certain rings, will not be allowed until you actually acquire the necessary item.

## Main Results

- [x] Source Code
 - https://colab.research.google.com/drive/1MAT1Jzh2zQUpkCU0pKWeR9_FqM4SlvTc?usp=sharing
 - Credit to https://colab.research.google.com/github/interactive-fiction-class/interactive-fiction-class.github.io/blob/master/homeworks/text-adventure-game/Text_Adventure_Game.ipynb for guidance on how to build a text-based game in Colab and credit to OpenAI for the deep learning language model, GPT-3.
- [x] Demo
 - https://youtu.be/ipwioty3RhM
- [x] Self Evaluation
 - I originally set out to improve on chatbot functionality but pivoted to directly improving text-based games using a deep learning language model. Even then, I initially wanted to integrate OpenAI with Ren'Py, because Ren'Py is a well-established free visual novel engine that has allowed thousands of creators around the world to put out choose-your-own-adventure style games. However, I ran into conflicts with different dependencies between Ren'Py and OpenAI, so I turned to Colab instead. After that, I was able to create a text-based game that depends on the output of OpenAI, so I did achieve that goal. However, it was a much more limited game due to the lack of real infrastructure on Colab for creating a game, and it was not what I first envisioned. I would say that I fulfilled what I planned but that the plan itself changed drastically from the original.

## Workload

Though I did not end up using my self-collected dataset from the progress report, that took approximately five hours to create and another two or three to clean into a computer-readable format. I had also spent a couple of hours looking into free chatbot code documentation online as well as algorithms for machine learning at that point. It was during an Office Hours where I was explaining to the professor that my focus changed, and I spent another five or so hours after the pivot learning about OpenAI GPT-3, BigScience Bloom, watching tutorials on how to use the API with Colab, going through the website to find the extent of my options, and exploring the capabilities of different GPT-3 models (Davinci, Curie, etc.) in the OpenAI Playground. Finding a text-based game format to begin with also took at least five hours; I spent a long time debugging Python versions and downloading different modules onto my computer while trying to connect Ren'Py with the OpenAI API. I even reached out to the developer of the Ren'Py Visual Novel Engine and exchanged traceback photos over a period of five days, although my endeavor to connect a third-party API to the engine was ultimately unsuccessful. I then had to search for other options online. I settled on using Google Colaboratory, because I have used Colab before for CS 410 projects, I found code for a text-based adventure game in Colab online and was able to verify that it worked as expected, and I was able to play around with GPT-3 in another Colab file that I created shortly after creating my account. My API key also expired on December 1st, which further complicated my plans, as I had to get another email and phone number to start another free trial for this project. It then took me about ten hours to modify and debug the text-based adventure game code from the Colab project I found online to create a somewhat cohesive game that accomplishes the goals I set out to accomplish.

All in all, I definitely spent more than the 20 hours a 1-person group is expected to have spent on this final project.
